WITH RECURSIVE TIME AS(
    SELECT 0 AS HOUR
    UNION ALL
    SELECT HOUR + 1
        FROM TIME
        WHERE HOUR < 23
)
SELECT HOUR, COUNT(ANIMAL_ID) AS COUNT
    FROM TIME T
    LEFT JOIN ANIMAL_OUTS O ON HOUR = HOUR(O.DATETIME)
    GROUP BY 1
    ORDER BY 1



















# WITH RECURSIVE BASE AS(
#     SELECT 0 AS HOUR
#     UNION ALL
#     SELECT HOUR + 1
#         FROM BASE
#         WHERE HOUR < 23
# )
# SELECT HOUR, COUNT(ANIMAL_ID) AS COUNT
#     FROM BASE B
#     LEFT JOIN ANIMAL_OUTS O
#       ON B.HOUR = HOUR(O.DATETIME)
#     GROUP BY 1
#     ORDER BY 1



















# WITH RECURSIVE TIME AS(
# #     SELECT 0 AS HOUR
# #     UNION ALL
# #     SELECT HOUR + 1
# #         FROM TIME
# #         WHERE HOUR < 23
# # )
# # SELECT T.HOUR, COUNT(ANIMAL_ID) AS COUNT
# #     FROM TIME T
# #     LEFT JOIN (SELECT *, HOUR(DATETIME) AS HOUR
# #             FROM ANIMAL_OUTS) O
# #       ON T.HOUR = O.HOUR
# #     GROUP BY 1
# #     ORDER BY 1
    
# # # SELECT * FROM ANIMAL_OUTS